#!/bin/bash
set -e
echo "### SANITY ###"
bazel query "deps(//...)" > /dev/null

echo ""
echo ""
echo ""
echo "### BUILDING ###"
./build_impacted

echo ""
echo ""
echo ""
echo "### TESTING ###"
./test_impacted

echo ""
echo ""
echo ""
echo "### Push Impacted ###"
./push_impacted

echo ""
echo ""
echo "" 
echo "### Packaging Impacted Applications ###"
find -L ./bazel-bin -name "APPLICATION.manifest" -delete
./list_applications_impacted | xargs bazel build 
find -L ./bazel-bin -name "APPLICATION.manifest"| xargs cat ; echo "--"



